%% This is an example first chapter.  You should put chapter/appendix that you
%% write into a separate file, and add a line \include{yourfilename} to
%% main.tex, where `yourfilename.tex' is the name of the chapter/appendix file.
%% You can process specific files by typing their names in at the 
%% \files=
%% prompt when you run the file main.tex through LaTeX.
\chapter{Infrastructure}

This chapter aims to describe the tools and processes involved in the infrastructure setup. From local development environment to the set of production servers running the Redch. Firstly, it explains the infrastructure setup and secondly, it describes the provisioning and deployment processes.

\section{Amazon AWS setup}

Amazon Web Services (AWS) is a cloud computing platform. It is a collection of remote computing services ranging from computing services, with the well-known Amazon EC2, and storage services, with Amazon S3, to networking services such as DNS among others. AWS is a world-wide leader of Infrastructure-as-a-Service (IaaS) providers. Lots of major web applications like Spotify, Airbnb, Foursquare Github and Mapbox rely on Amazon Web Services.

The whole infrastructure is compound by EC2 instances, virtual servers in Amazon's cloud. They all run a custom Amazon Machine Image (AMI) built from a raw Ubuntu 12.04 LTS AMI installing all needed dependencies: Puppet and Ruby 2.0.0. As a result any new instance booted up with this custom AMI is ready the be provisioned. Starting and stopping machines, as well as configuring their firewall rules is managed through the AWS Management Console, a web UI.

One of the major benefits Redch can take advantage of is Auto Scaling. It allows to scale the number of EC2 instances up and down according to a set of predefined conditions. The load balancer, for instance, can automatically spawn app servers based on load. Redch can get the most out of it exploiting the fact that solar panels don't produce energy at night, so no requests from those sensors will be received during night. This allows to reduce the computing power to bare minimum. (wind mills?)

As for the database server, although it is desirable to keep the infrastructure provider-independent, it makes use of the Amazon RDS. A service... Among its upsides... fine-grained configuration and monitoring.

\section{Provisioning}

Once the software is developed the underlying infrastructure must be configured to run each of the system components. This process, that involves creating directories and installing packages, may be error-prone when done manually. Besides, it may need to be repeated next time we have to set up another server. Even though, writing down the build-out process may help, whoever reads that documentation can't figure out the current state of the configuration.

Puppet, among other solutions such as Chef, is a software that enables server configuration automation. It automates server provisioning by formalizing its configuration into manifests. Puppet's manifests are text files that contain statements written in a declarative domain-specific language (DSL) that allows to define the desired state of the infrastructure. Once these configurations are deployed, Puppet automatically installs the necessary packages and ensures that the machineâ€™s files and services match the desired state.

Moreover, Puppet is a mature and widely used product with open source version and lots of tutorials and other learning materials are available online.

Server automation frameworks formalize systems administration treating infrastructure as code. As a result, infrastructure's configuration can be tested and repeated, automating away repetitive tasks while systems administrators focus on architecting and tunning services.

First of all any server to be provisioned must have puppet installed, which comes packaged as a ruby gem. Therefore, Puppet requires an MRI Ruby interpreter. As of this writing, the current stable release is the 3.4.3 which supports 2.0.x ruby versions. Although Puppet can be installed with any system package manager, it will likely install previous releases missing features and bug fixes.

Puppet allows to provision a machines by login into them through ssh and running

